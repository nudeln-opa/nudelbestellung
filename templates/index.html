<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>üçù Nudelbestellung</title>
</head>
<body>

    <h1>üçù Nudelbestellung</h1>
    <h3>Nudeln wie zu Omas Zeiten ‚Äì Ohne Geschmacksverst√§rker und Aromen</h3>

    <form method="post" action="/submit">
        <label for="name">Name:</label>
        <input type="text" name="name" required>
        
        <label for="email">Email:</label>
        <input type="email" name="email" required>

        <label for="payment">Zahlungsart:</label>
        <select name="payment">
            <option value="Bar">Bar</option>
            <option value="PayPal">PayPal</option>
        </select>

        <!-- ‚úÖ Hartweizen-Tabelle -->
        <h2>Hartweizen-Nudeln</h2>
        <table border="1" cellpadding="5">
            <tr>
                <th>Bild</th>
                <th>Nudel (500g)</th>
                <th>Preis (‚Ç¨)</th>
                <th>Menge</th>
            </tr>
            {% for i, noodle in enumerate(noodles) if not noodle.lower().startswith('dinkel') %}
            <tr>
                <td>
                    <img src="{{ url_for('static', filename='images/' + noodle.replace(' ', '_') + '.JPG') }}" alt="{{ noodle }}" width="100">
                </td>
                <td>{{ noodle }}</td>
                <td>2.50</td>
                <td><input type="number" name="qty_{{ i+1 }}" min="0" value="0"></td>
            </tr>
            {% endfor %}
        </table>

        <!-- ‚úÖ Dinkel-Tabelle -->
        <h2>Dinkel-Nudeln</h2>
        <table border="1" cellpadding="5">
            <tr>
                <th>Bild</th>
                <th>Nudel (500g)</th>
                <th>Preis (‚Ç¨)</th>
                <th>Menge</th>
            </tr>
            {% for i, noodle in enumerate(noodles) if noodle.lower().startswith('dinkel') %}
            <tr>
                <td>
                    <img src="{{ url_for('static', filename='images/' + noodle.replace(' ', '_') + '.JPG') }}" alt="{{ noodle }}" width="100">
                </td>
                <td>{{ noodle }}</td>
                <td>2.50</td>
                <td><input type="number" name="qty_{{ i+1 }}" min="0" value="0"></td>
            </tr>
            {% endfor %}
        </table>

        <p>
            <strong>Gesamtanzahl:</strong> <span id="totalQty">0</span> Packungen<br>
            <strong>Gratis-Packungen:</strong> <span id="freePacks">0</span><br>
            <strong>Zu zahlen:</strong> <span id="totalPrice">0.00 ‚Ç¨</span>
        </p>

        <button type="submit">Bestellen</button>
    </form>

    <script>
        const pricePerPack = 2.5;
        const qtyInputs = document.querySelectorAll('input[type="number"]');
        const totalQtySpan = document.getElementById("totalQty");
        const freePacksSpan = document.getElementById("freePacks");
        const totalPriceSpan = document.getElementById("totalPrice");

        function updateSummary() {
            let totalQty = 0;
            qtyInputs.forEach(input => {
                totalQty += parseInt(input.value) || 0;
            });

            let freePacks = Math.floor(totalQty / 10);
            let totalPrice = (totalQty - freePacks) * pricePerPack;

            totalQtySpan.textContent = totalQty;
            freePacksSpan.textContent = freePacks;
            totalPriceSpan.textContent = totalPrice.toFixed(2) + " ‚Ç¨";
        }

        qtyInputs.forEach(input => {
            input.addEventListener("input", updateSummary);
        });
    </script>

</body>
</html>
